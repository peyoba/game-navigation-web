(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[155],{6882:function(e,t,l){Promise.resolve().then(l.bind(l,147))},147:function(e,t,l){"use strict";l.r(t),l.d(t,{default:function(){return m}});var s=l(7437),r=l(2265),a=l(9376),n=l(7648),i=l(3541),d=l(6780),c=l(5820),o=l(981);function m(){let e=(0,a.useRouter)(),{language:t}=(0,i.Z)(),[l,m]=(0,r.useState)([]),[h,u]=(0,r.useState)(!0),[x,g]=(0,r.useState)(""),[b,y]=(0,r.useState)(!1),[f,p]=(0,r.useState)({titleZh:"",titleEn:"",descZh:"",descEn:"",imageUrl:"",gameUrl:"",categoryId:0,isActive:!0}),[j,v]=(0,r.useState)({}),[N,E]=(0,r.useState)(!1);(0,r.useEffect)(()=>{try{let e=(0,c.tG)();m(e),u(!1)}catch(e){console.error("Error loading categories:",e),u(!1)}},[]);let w=e=>{let{name:t,value:l}=e.target;p(e=>({...e,[t]:l})),j[t]&&v(e=>{let l={...e};return delete l[t],l}),"gameUrl"===t&&g(l)},U=async e=>{let l,s;"titleZh"===e?(l="titleEn",s="en"):"titleEn"===e?(l="titleZh",s="zh"):"descZh"===e?(l="descEn",s="en"):(l="descZh",s="zh");let r=f[e];if(!r||""===r.trim()){alert("zh"===t?"请先输入需要翻译的内容":"Please enter content to translate first");return}y(!0);try{let e=await (0,o.O)(r,s);p(t=>({...t,[l]:e})),j[l]&&v(e=>{let t={...e};return delete t[l],t})}catch(e){console.error("Translation error:",e),alert("zh"===t?"翻译失败，请稍后重试或手动输入":"Translation failed, please try again later or enter manually")}finally{y(!1)}},Z=()=>{let e={};return f.titleZh.trim()||(e.titleZh="请输入中文标题"),f.titleEn.trim()||(e.titleEn="Please enter English title"),f.descZh.trim()||(e.descZh="请输入中文描述"),f.descEn.trim()||(e.descEn="Please enter English description"),f.imageUrl&&f.imageUrl.trim()&&!k(f.imageUrl)&&(e.imageUrl="zh"===t?"请输入有效的图片URL":"Please enter a valid image URL"),f.gameUrl.trim()?k(f.gameUrl)||(e.gameUrl="zh"===t?"请输入有效的游戏URL":"Please enter a valid game URL"):e.gameUrl="zh"===t?"请输入游戏链接":"Please enter game URL",f.categoryId||(e.categoryId="zh"===t?"请选择游戏分类":"Please select a category"),v(e),0===Object.keys(e).length},k=e=>{try{return new URL(e),!0}catch(e){return!1}},z=async l=>{if(l.preventDefault(),Z()){E(!0);try{let l=(0,c.s2)({...f,categoryId:Number(f.categoryId)});console.log("Game added:",l),alert("zh"===t?"游戏添加成功！":"Game added successfully!"),e.push("/admin")}catch(e){console.error("Error adding game:",e),alert("zh"===t?"添加游戏失败，请重试！":"Failed to add game, please try again!")}finally{E(!1)}}};return h?(0,s.jsx)("div",{className:"text-center py-8",children:"Loading..."}):(0,s.jsxs)("div",{children:[(0,s.jsx)(d.Z,{}),(0,s.jsxs)("div",{className:"container mx-auto px-4 py-8",children:[(0,s.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,s.jsx)("h1",{className:"text-2xl font-bold",children:"zh"===t?"添加新游戏":"Add New Game"}),(0,s.jsx)(n.default,{href:"/admin",className:"btn-secondary",children:"zh"===t?"返回":"Back"})]}),(0,s.jsx)("div",{className:"mb-6 bg-blue-50 border border-blue-200 rounded-lg p-4",children:(0,s.jsxs)("div",{className:"flex items-start",children:[(0,s.jsx)("div",{className:"flex-shrink-0 mt-0.5",children:(0,s.jsx)("svg",{className:"h-5 w-5 text-blue-600",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})}),(0,s.jsxs)("div",{className:"ml-3",children:[(0,s.jsx)("h3",{className:"text-sm font-medium text-blue-800",children:"zh"===t?"自动翻译功能":"Auto Translation Feature"}),(0,s.jsx)("div",{className:"mt-1 text-sm text-blue-700",children:(0,s.jsx)("p",{children:"zh"===t?'只需填写其中一种语言，然后点击"翻译"按钮，系统将自动为您翻译成另一种语言。':'Fill in just one language, then click the "Translate" button, and the system will automatically translate it into the other language for you.'})})]})]})}),(0,s.jsx)("div",{className:"bg-white rounded-lg shadow-md p-6",children:(0,s.jsxs)("form",{onSubmit:z,className:"space-y-6",children:[(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,s.jsxs)("div",{children:[(0,s.jsxs)("div",{className:"flex justify-between items-center mb-1",children:[(0,s.jsx)("label",{htmlFor:"titleZh",className:"block text-sm font-medium text-gray-700",children:"中文标题"}),(0,s.jsx)("button",{type:"button",onClick:()=>U("titleZh"),disabled:b||!f.titleZh,className:"text-xs bg-blue-50 text-blue-700 hover:bg-blue-100 py-1 px-2 rounded disabled:opacity-50",children:b?"翻译中...":"翻译为英文 →"})]}),(0,s.jsx)("input",{type:"text",id:"titleZh",name:"titleZh",value:f.titleZh,onChange:w,className:"w-full rounded-md border ".concat(j.titleZh?"border-red-500":"border-gray-300"," px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500")}),j.titleZh&&(0,s.jsx)("p",{className:"text-red-500 text-sm mt-1",children:j.titleZh})]}),(0,s.jsxs)("div",{children:[(0,s.jsxs)("div",{className:"flex justify-between items-center mb-1",children:[(0,s.jsx)("label",{htmlFor:"titleEn",className:"block text-sm font-medium text-gray-700",children:"English Title"}),(0,s.jsx)("button",{type:"button",onClick:()=>U("titleEn"),disabled:b||!f.titleEn,className:"text-xs bg-blue-50 text-blue-700 hover:bg-blue-100 py-1 px-2 rounded disabled:opacity-50",children:b?"Translating...":"← Translate to Chinese"})]}),(0,s.jsx)("input",{type:"text",id:"titleEn",name:"titleEn",value:f.titleEn,onChange:w,className:"w-full rounded-md border ".concat(j.titleEn?"border-red-500":"border-gray-300"," px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500")}),j.titleEn&&(0,s.jsx)("p",{className:"text-red-500 text-sm mt-1",children:j.titleEn})]}),(0,s.jsxs)("div",{children:[(0,s.jsxs)("div",{className:"flex justify-between items-center mb-1",children:[(0,s.jsx)("label",{htmlFor:"descZh",className:"block text-sm font-medium text-gray-700",children:"中文描述"}),(0,s.jsx)("button",{type:"button",onClick:()=>U("descZh"),disabled:b||!f.descZh,className:"text-xs bg-blue-50 text-blue-700 hover:bg-blue-100 py-1 px-2 rounded disabled:opacity-50",children:b?"翻译中...":"翻译为英文 →"})]}),(0,s.jsx)("textarea",{id:"descZh",name:"descZh",rows:3,value:f.descZh,onChange:w,className:"w-full rounded-md border ".concat(j.descZh?"border-red-500":"border-gray-300"," px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500")}),j.descZh&&(0,s.jsx)("p",{className:"text-red-500 text-sm mt-1",children:j.descZh})]}),(0,s.jsxs)("div",{children:[(0,s.jsxs)("div",{className:"flex justify-between items-center mb-1",children:[(0,s.jsx)("label",{htmlFor:"descEn",className:"block text-sm font-medium text-gray-700",children:"English Description"}),(0,s.jsx)("button",{type:"button",onClick:()=>U("descEn"),disabled:b||!f.descEn,className:"text-xs bg-blue-50 text-blue-700 hover:bg-blue-100 py-1 px-2 rounded disabled:opacity-50",children:b?"Translating...":"← Translate to Chinese"})]}),(0,s.jsx)("textarea",{id:"descEn",name:"descEn",rows:3,value:f.descEn,onChange:w,className:"w-full rounded-md border ".concat(j.descEn?"border-red-500":"border-gray-300"," px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500")}),j.descEn&&(0,s.jsx)("p",{className:"text-red-500 text-sm mt-1",children:j.descEn})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{htmlFor:"imageUrl",className:"block text-sm font-medium text-gray-700 mb-1",children:"zh"===t?"图片链接 (可选)":"Image URL (Optional)"}),(0,s.jsx)("input",{type:"text",id:"imageUrl",name:"imageUrl",value:f.imageUrl,onChange:w,placeholder:"https://example.com/image.jpg",className:"w-full rounded-md border ".concat(j.imageUrl?"border-red-500":"border-gray-300"," px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500")}),j.imageUrl&&(0,s.jsx)("p",{className:"text-red-500 text-sm mt-1",children:j.imageUrl}),f.imageUrl&&k(f.imageUrl)&&(0,s.jsxs)("div",{className:"mt-2",children:[(0,s.jsx)("p",{className:"text-sm text-gray-500 mb-1",children:"zh"===t?"图片预览:":"Image Preview:"}),(0,s.jsx)("img",{src:f.imageUrl,alt:"Preview",className:"h-40 object-contain rounded-md border border-gray-200"})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{htmlFor:"gameUrl",className:"block text-sm font-medium text-gray-700 mb-1",children:"zh"===t?"游戏链接":"Game URL"}),(0,s.jsx)("input",{type:"text",id:"gameUrl",name:"gameUrl",value:f.gameUrl,onChange:w,placeholder:"https://example.com/game.html",className:"w-full rounded-md border ".concat(j.gameUrl?"border-red-500":"border-gray-300"," px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500")}),j.gameUrl&&(0,s.jsx)("p",{className:"text-red-500 text-sm mt-1",children:j.gameUrl}),x&&k(x)&&(0,s.jsxs)("div",{className:"mt-2",children:[(0,s.jsx)("p",{className:"text-sm text-gray-500 mb-1",children:"zh"===t?"游戏预览:":"Game Preview:"}),(0,s.jsx)("div",{className:"border border-gray-200 rounded-md overflow-hidden aspect-video",children:(0,s.jsx)("iframe",{src:x,className:"w-full h-full",title:"Game Preview"})})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{htmlFor:"categoryId",className:"block text-sm font-medium text-gray-700 mb-1",children:"zh"===t?"游戏分类":"Game Category"}),(0,s.jsxs)("select",{id:"categoryId",name:"categoryId",value:f.categoryId,onChange:w,className:"w-full rounded-md border ".concat(j.categoryId?"border-red-500":"border-gray-300"," px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 bg-white"),children:[(0,s.jsx)("option",{value:"0",children:"zh"===t?"-- 选择分类 --":"-- Select Category --"}),l.map(e=>(0,s.jsx)("option",{value:e.id,children:"zh"===t?e.nameZh:e.nameEn},e.id))]}),j.categoryId&&(0,s.jsx)("p",{className:"text-red-500 text-sm mt-1",children:j.categoryId})]}),(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)("input",{type:"checkbox",id:"isActive",name:"isActive",checked:f.isActive,onChange:e=>{let{name:t,checked:l}=e.target;p(e=>({...e,[t]:l}))},className:"h-4 w-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500"}),(0,s.jsx)("label",{htmlFor:"isActive",className:"ml-2 block text-sm text-gray-700",children:"zh"===t?"立即发布":"Publish Immediately"})]}),(0,s.jsx)("div",{className:"flex justify-end",children:(0,s.jsx)("button",{type:"submit",disabled:N,className:"px-6 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 disabled:opacity-50",children:N?"zh"===t?"提交中...":"Submitting...":"zh"===t?"添加游戏":"Add Game"})})]})})]})]})}}},function(e){e.O(0,[648,677,971,117,744],function(){return e(e.s=6882)}),_N_E=e.O()}]);