(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[798],{9672:function(e,t,s){Promise.resolve().then(s.bind(s,6155))},6155:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return m}});var l=s(7437),a=s(2265),r=s(9376),n=s(7648),i=s(3541),d=s(6780),c=s(981),o=s(5820);function m(e){let{params:t}=e,s=(0,r.useRouter)(),{language:m}=(0,i.Z)(),[h,u]=(0,a.useState)([]),[x,g]=(0,a.useState)(!0),[b,f]=(0,a.useState)(!1),[p,y]=(0,a.useState)(""),[j,v]=(0,a.useState)(!1),[N,E]=(0,a.useState)({titleZh:"",titleEn:"",descZh:"",descEn:"",imageUrl:"",gameUrl:"",categoryId:0,isActive:!0}),[U,w]=(0,a.useState)({}),[Z,z]=(0,a.useState)(!1);(0,a.useEffect)(()=>{!async function(){try{let e=(0,o.tG)();u(e);let s=parseInt(t.id),l=(0,o.bg)(s);l?(E({titleZh:l.titleZh,titleEn:l.titleEn,descZh:l.descZh,descEn:l.descEn,imageUrl:l.imageUrl||"",gameUrl:l.gameUrl,categoryId:l.categoryId,isActive:l.isActive}),y(l.gameUrl)):f(!0),g(!1)}catch(e){console.error("Error fetching data:",e),g(!1),f(!0)}}()},[t.id]);let k=e=>{let{name:t,value:s}=e.target;E(e=>({...e,[t]:s})),U[t]&&w(e=>{let s={...e};return delete s[t],s}),"gameUrl"===t&&y(s)},C=async e=>{let t,s;"titleZh"===e?(t="titleEn",s="en"):"titleEn"===e?(t="titleZh",s="zh"):"descZh"===e?(t="descEn",s="en"):(t="descZh",s="zh");let l=N[e];if(!l||""===l.trim()){alert("zh"===m?"请先输入需要翻译的内容":"Please enter content to translate first");return}v(!0);try{let e=await (0,c.O)(l,s);E(s=>({...s,[t]:e})),U[t]&&w(e=>{let s={...e};return delete s[t],s})}catch(e){console.error("Translation error:",e),alert("zh"===m?"翻译失败，请稍后重试或手动输入":"Translation failed, please try again later or enter manually")}finally{v(!1)}},I=()=>{let e={};return N.titleZh.trim()||(e.titleZh="请输入中文标题"),N.titleEn.trim()||(e.titleEn="Please enter English title"),N.descZh.trim()||(e.descZh="请输入中文描述"),N.descEn.trim()||(e.descEn="Please enter English description"),N.imageUrl&&N.imageUrl.trim()&&!P(N.imageUrl)&&(e.imageUrl="zh"===m?"请输入有效的图片URL":"Please enter a valid image URL"),N.gameUrl.trim()?P(N.gameUrl)||(e.gameUrl="zh"===m?"请输入有效的游戏URL":"Please enter a valid game URL"):e.gameUrl="zh"===m?"请输入游戏链接":"Please enter game URL",N.categoryId||(e.categoryId="zh"===m?"请选择游戏分类":"Please select a category"),w(e),0===Object.keys(e).length},P=e=>{try{return new URL(e),!0}catch(e){return!1}},S=async e=>{if(e.preventDefault(),I()){z(!0);try{let e=parseInt(t.id),l=(0,o.Bi)(e,{...N,categoryId:Number(N.categoryId)});l?(console.log("Game updated:",l),alert("zh"===m?"游戏更新成功！":"Game updated successfully!"),s.push("/admin")):alert("zh"===m?"更新失败，未找到游戏！":"Update failed, game not found!")}catch(e){console.error("Error updating game:",e),alert("zh"===m?"更新游戏失败，请重试！":"Failed to update game, please try again!")}finally{z(!1)}}};return x?(0,l.jsx)("div",{className:"text-center py-8",children:"Loading..."}):b?(0,l.jsxs)("div",{children:[(0,l.jsx)(d.Z,{}),(0,l.jsxs)("div",{className:"container mx-auto px-4 py-8 text-center",children:[(0,l.jsx)("h1",{className:"text-2xl font-bold mb-4",children:"zh"===m?"游戏未找到":"Game Not Found"}),(0,l.jsx)(n.default,{href:"/admin",className:"btn-primary",children:"zh"===m?"返回游戏管理":"Back to Game Management"})]})]}):(0,l.jsxs)("div",{children:[(0,l.jsx)(d.Z,{}),(0,l.jsxs)("div",{className:"container mx-auto px-4 py-8",children:[(0,l.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,l.jsx)("h1",{className:"text-2xl font-bold",children:"zh"===m?"编辑游戏":"Edit Game"}),(0,l.jsx)(n.default,{href:"/admin",className:"btn-secondary",children:"zh"===m?"返回":"Back"})]}),(0,l.jsx)("div",{className:"mb-6 bg-blue-50 border border-blue-200 rounded-lg p-4",children:(0,l.jsxs)("div",{className:"flex items-start",children:[(0,l.jsx)("div",{className:"flex-shrink-0 mt-0.5",children:(0,l.jsx)("svg",{className:"h-5 w-5 text-blue-600",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,l.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})}),(0,l.jsxs)("div",{className:"ml-3",children:[(0,l.jsx)("h3",{className:"text-sm font-medium text-blue-800",children:"zh"===m?"自动翻译功能":"Auto Translation Feature"}),(0,l.jsx)("div",{className:"mt-1 text-sm text-blue-700",children:(0,l.jsx)("p",{children:"zh"===m?'只需修改其中一种语言，然后点击"翻译"按钮，系统将自动为您翻译成另一种语言。':'Just modify one language, then click the "Translate" button, and the system will automatically translate it into the other language for you.'})})]})]})}),(0,l.jsx)("div",{className:"bg-white rounded-lg shadow-md p-6",children:(0,l.jsxs)("form",{onSubmit:S,className:"space-y-6",children:[(0,l.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,l.jsxs)("div",{children:[(0,l.jsxs)("div",{className:"flex justify-between items-center mb-1",children:[(0,l.jsx)("label",{htmlFor:"titleZh",className:"block text-sm font-medium text-gray-700",children:"中文标题"}),(0,l.jsx)("button",{type:"button",onClick:()=>C("titleZh"),disabled:j||!N.titleZh,className:"text-xs bg-blue-50 text-blue-700 hover:bg-blue-100 py-1 px-2 rounded disabled:opacity-50",children:j?"翻译中...":"翻译为英文 →"})]}),(0,l.jsx)("input",{type:"text",id:"titleZh",name:"titleZh",value:N.titleZh,onChange:k,className:"w-full rounded-md border ".concat(U.titleZh?"border-red-500":"border-gray-300"," px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500")}),U.titleZh&&(0,l.jsx)("p",{className:"text-red-500 text-sm mt-1",children:U.titleZh})]}),(0,l.jsxs)("div",{children:[(0,l.jsxs)("div",{className:"flex justify-between items-center mb-1",children:[(0,l.jsx)("label",{htmlFor:"titleEn",className:"block text-sm font-medium text-gray-700",children:"English Title"}),(0,l.jsx)("button",{type:"button",onClick:()=>C("titleEn"),disabled:j||!N.titleEn,className:"text-xs bg-blue-50 text-blue-700 hover:bg-blue-100 py-1 px-2 rounded disabled:opacity-50",children:j?"Translating...":"← Translate to Chinese"})]}),(0,l.jsx)("input",{type:"text",id:"titleEn",name:"titleEn",value:N.titleEn,onChange:k,className:"w-full rounded-md border ".concat(U.titleEn?"border-red-500":"border-gray-300"," px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500")}),U.titleEn&&(0,l.jsx)("p",{className:"text-red-500 text-sm mt-1",children:U.titleEn})]}),(0,l.jsxs)("div",{children:[(0,l.jsxs)("div",{className:"flex justify-between items-center mb-1",children:[(0,l.jsx)("label",{htmlFor:"descZh",className:"block text-sm font-medium text-gray-700",children:"中文描述"}),(0,l.jsx)("button",{type:"button",onClick:()=>C("descZh"),disabled:j||!N.descZh,className:"text-xs bg-blue-50 text-blue-700 hover:bg-blue-100 py-1 px-2 rounded disabled:opacity-50",children:j?"翻译中...":"翻译为英文 →"})]}),(0,l.jsx)("textarea",{id:"descZh",name:"descZh",rows:3,value:N.descZh,onChange:k,className:"w-full rounded-md border ".concat(U.descZh?"border-red-500":"border-gray-300"," px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500")}),U.descZh&&(0,l.jsx)("p",{className:"text-red-500 text-sm mt-1",children:U.descZh})]}),(0,l.jsxs)("div",{children:[(0,l.jsxs)("div",{className:"flex justify-between items-center mb-1",children:[(0,l.jsx)("label",{htmlFor:"descEn",className:"block text-sm font-medium text-gray-700",children:"English Description"}),(0,l.jsx)("button",{type:"button",onClick:()=>C("descEn"),disabled:j||!N.descEn,className:"text-xs bg-blue-50 text-blue-700 hover:bg-blue-100 py-1 px-2 rounded disabled:opacity-50",children:j?"Translating...":"← Translate to Chinese"})]}),(0,l.jsx)("textarea",{id:"descEn",name:"descEn",rows:3,value:N.descEn,onChange:k,className:"w-full rounded-md border ".concat(U.descEn?"border-red-500":"border-gray-300"," px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500")}),U.descEn&&(0,l.jsx)("p",{className:"text-red-500 text-sm mt-1",children:U.descEn})]})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{htmlFor:"imageUrl",className:"block text-sm font-medium text-gray-700 mb-1",children:"zh"===m?"图片链接 (可选)":"Image URL (Optional)"}),(0,l.jsx)("input",{type:"text",id:"imageUrl",name:"imageUrl",value:N.imageUrl,onChange:k,placeholder:"https://example.com/image.jpg",className:"w-full rounded-md border ".concat(U.imageUrl?"border-red-500":"border-gray-300"," px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500")}),U.imageUrl&&(0,l.jsx)("p",{className:"text-red-500 text-sm mt-1",children:U.imageUrl}),N.imageUrl&&P(N.imageUrl)&&(0,l.jsxs)("div",{className:"mt-2",children:[(0,l.jsx)("p",{className:"text-sm text-gray-500 mb-1",children:"zh"===m?"图片预览:":"Image Preview:"}),(0,l.jsx)("img",{src:N.imageUrl,alt:"Preview",className:"h-40 object-contain rounded-md border border-gray-200"})]})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{htmlFor:"gameUrl",className:"block text-sm font-medium text-gray-700 mb-1",children:"zh"===m?"游戏链接":"Game URL"}),(0,l.jsx)("input",{type:"text",id:"gameUrl",name:"gameUrl",value:N.gameUrl,onChange:k,placeholder:"https://example.com/game.html",className:"w-full rounded-md border ".concat(U.gameUrl?"border-red-500":"border-gray-300"," px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500")}),U.gameUrl&&(0,l.jsx)("p",{className:"text-red-500 text-sm mt-1",children:U.gameUrl}),p&&P(p)&&(0,l.jsxs)("div",{className:"mt-2",children:[(0,l.jsx)("p",{className:"text-sm text-gray-500 mb-1",children:"zh"===m?"游戏预览:":"Game Preview:"}),(0,l.jsx)("div",{className:"border border-gray-200 rounded-md overflow-hidden aspect-video",children:(0,l.jsx)("iframe",{src:p,className:"w-full h-full",title:"Game Preview"})})]})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{htmlFor:"categoryId",className:"block text-sm font-medium text-gray-700 mb-1",children:"zh"===m?"游戏分类":"Game Category"}),(0,l.jsxs)("select",{id:"categoryId",name:"categoryId",value:N.categoryId,onChange:k,className:"w-full rounded-md border ".concat(U.categoryId?"border-red-500":"border-gray-300"," px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 bg-white"),children:[(0,l.jsx)("option",{value:"0",children:"zh"===m?"-- 选择分类 --":"-- Select Category --"}),h.map(e=>(0,l.jsx)("option",{value:e.id,children:"zh"===m?e.nameZh:e.nameEn},e.id))]}),U.categoryId&&(0,l.jsx)("p",{className:"text-red-500 text-sm mt-1",children:U.categoryId})]}),(0,l.jsxs)("div",{className:"flex items-center",children:[(0,l.jsx)("input",{type:"checkbox",id:"isActive",name:"isActive",checked:N.isActive,onChange:e=>{let{name:t,checked:s}=e.target;E(e=>({...e,[t]:s}))},className:"h-4 w-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500"}),(0,l.jsx)("label",{htmlFor:"isActive",className:"ml-2 block text-sm text-gray-700",children:"zh"===m?"启用游戏":"Enable Game"})]}),(0,l.jsx)("div",{className:"flex justify-end",children:(0,l.jsx)("button",{type:"submit",disabled:Z,className:"px-6 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 disabled:opacity-50",children:Z?"zh"===m?"保存中...":"Saving...":"zh"===m?"保存更改":"Save Changes"})})]})})]})]})}}},function(e){e.O(0,[648,677,971,117,744],function(){return e(e.s=9672)}),_N_E=e.O()}]);